(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[5],{133:function(e,t,a){e.exports={"message-form":"MessageForm_message-form__S3R8e","message-form__actions":"MessageForm_message-form__actions__2Kyl-"}},134:function(e,t,a){e.exports={"message-list__items":"MessageList_message-list__items__2exG8","message-error__text":"MessageList_message-error__text__mIE98",center:"MessageList_center__2zBoh"}},135:function(e,t,a){e.exports={"msg-list__item":"MessageItem_msg-list__item__1-LrI","msg-list__item-container":"MessageItem_msg-list__item-container__1luOY",own:"MessageItem_own__3aZkM"}},139:function(e,t,a){"use strict";a.r(t);var n=a(17),s=a(5),c=a.n(s),r=a(18),o=a(12),i=a(3),l=a(1),u=a(96),m=a(133),j=a.n(m),g=a(14),_=a(88),b=a(83),d=a(16),p=a(15),h=a(0),O=function(e){var t=Object(b.a)(),a=t.value,s=t.valueChangeHandler,r=t.setValue,i=Object(d.a)(),l=i.isLoading,u=i.error,m=i.sendRequest,O=i.clearError,x=function(){var t=Object(o.a)(c.a.mark((function t(s){var o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.preventDefault(),t.prev=1,t.next=4,m("".concat("https://mern-book-social.herokuapp.com/api","/messages"),"POST",JSON.stringify({creatorId:e.userData.id,message:a}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.token)});case 4:o=t.sent,e.onAddMessage(Object(n.a)({},o.message)),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:r("");case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[u&&Object(h.jsx)(p.a,{onClose:O,text:u,onlyBack:!0,overlay:!0}),Object(h.jsxs)("form",{onSubmit:x,children:[Object(h.jsx)(_.a,{textarea:!0,placeholder:"Write a message, ".concat(e.userData.name),rows:"5",onChange:s,value:a,msg:!0}),Object(h.jsx)("div",{className:j.a["message-form__actions"],children:Object(h.jsx)(g.a,{type:"submit",children:l?"Sending":"Send Message"})})]})]})},x=a(134),f=a.n(x),v=a(135),k=a.n(v),w=function(e){var t=e.name!==e.username?"".concat(k.a["msg-list__item-container"]):"".concat(k.a["msg-list__item-container"]," ").concat(k.a.own);return Object(h.jsx)("li",{className:k.a["msg-list__item"],children:Object(h.jsxs)("div",{className:t,children:[Object(h.jsx)("h4",{children:e.name}),Object(h.jsx)("p",{children:e.message})]})})},y=function(e){var t=Object(l.useRef)(),a=e.messages;return Object(l.useEffect)((function(){a&&t.current.scrollIntoView({behavior:"smooth"})})),Object(h.jsxs)("ul",{className:f.a["message-list__items"],children:[e.messages.length>0&&e.totalPages!==e.page&&Object(h.jsx)("div",{className:f.a.center,children:Object(h.jsx)(g.a,{inverse:!0,onClick:function(){e.onPrev()},children:"Prev"})}),e.messages.length>0&&e.messages.map((function(t){return Object(h.jsx)(w,{id:t.id,message:t.message,name:t.creatorId.name,username:e.username},t.id)})),0===e.messages.length&&Object(h.jsx)("h1",{className:f.a["message-error__text"],children:"No Messages Found"}),e.messages.length>0&&e.page>1&&Object(h.jsx)("div",{className:f.a.center,children:Object(h.jsx)(g.a,{inverse:!0,onClick:function(){e.onNext()},children:"Next"})}),Object(h.jsx)("div",{ref:t})]})},C=a(26),N=a(7);t.default=function(){var e=Object(l.useState)([]),t=Object(i.a)(e,2),a=t[0],s=t[1],m=Object(l.useState)(1),j=Object(i.a)(m,2),g=j[0],_=j[1],b=Object(l.useState)(1),x=Object(i.a)(b,2),f=x[0],v=x[1],k=Object(d.a)(),w=k.isLoading,I=k.error,M=k.sendRequest,F=k.clearError,S=Object(l.useContext)(N.a),T=S.token;Object(l.useEffect)((function(){var e=function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M("".concat("https://mern-book-social.herokuapp.com/api","/messages/?page=").concat(g),"GET",null,{Authorization:"Bearer ".concat(T)});case 3:t=e.sent,v(t.totalPages),s(Object(r.a)(t.messages.sort((function(e,t){return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()})))),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[M,g,T]);return Object(l.useEffect)((function(){Object(u.a)("https://mern-book-social.herokuapp.com").on("new-message",(function(e){e&&s((function(t){return[].concat(Object(r.a)(t),[Object(n.a)({},e.message)])}))}))}),[]),Object(h.jsxs)(h.Fragment,{children:[I&&Object(h.jsx)(p.a,{onClose:F,text:I,onlyBack:!0,overlay:!0}),w&&Object(h.jsx)(C.a,{center:!0}),Object(h.jsx)(y,{messages:a,username:S.userData.name,onPrev:function(){_((function(e){return e<=f?e+1:e}))},onNext:function(){_((function(e){return e>1?e-1:e}))},isLoading:w,page:g,totalPages:f}),Object(h.jsx)(O,{userData:S.userData,token:T})]})}},83:function(e,t,a){"use strict";var n=a(3),s=a(1);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(s.useState)(e),a=Object(n.a)(t,2),c=a[0],r=a[1],o=Object(s.useCallback)((function(e){r(e.target.value)}),[]);return{value:c,valueChangeHandler:o,setValue:r}}},88:function(e,t,a){"use strict";a(1);var n=a(91),s=a.n(n),c=a(0);t.a=function(e){var t=Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("label",{htmlFor:e.for,children:e.label}),Object(c.jsx)("input",{type:e.type||"text",onChange:e.onChange,value:e.value,placeholder:e.placeholder})]});return e.textarea&&(t=Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("label",{htmlFor:e.for,children:e.label}),Object(c.jsx)("textarea",{type:e.type||"text",rows:e.rows||3,onChange:e.onChange,value:e.value,placeholder:e.placeholder})]})),e.dual&&(t=Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:s.a["input-container__dual-div"],children:[Object(c.jsx)("label",{htmlFor:e.forOne,children:e.labelOne}),Object(c.jsx)("input",{type:e.typeOne||"text",onChange:e.onChangeOne,value:e.valueOne,placeholder:e.placeholder})]}),Object(c.jsxs)("div",{className:s.a["input-container__dual-div"],children:[Object(c.jsx)("label",{htmlFor:e.forTwo,children:e.labelTwo}),Object(c.jsx)("input",{type:e.typeTwo||"text",onChange:e.onChangeTwo,value:e.valueTwo,placeholder:e.placeholder})]})]})),Object(c.jsx)("div",{className:e.dual?s.a["input-container__dual"]:"".concat(s.a["input-container"]," ").concat(e.msg&&s.a.msg),children:t})}},91:function(e,t,a){e.exports={"input-container":"Input_input-container__3uy4l","input-container__dual":"Input_input-container__dual__1HZ6I","input-container__dual-div":"Input_input-container__dual-div__nEqMd",msg:"Input_msg__1eA6Y"}}}]);
//# sourceMappingURL=5.796dedfd.chunk.js.map